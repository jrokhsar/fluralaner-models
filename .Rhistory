matplot(times, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100, 12000))
abline(v=c(9985/365), col="green", lty=4, lwd= 2)
legend(11000, 0.2, c("Dogs"), pch = 16, col = c("blue"))
matplot(times, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100, 12000))
abline(v=c(9985/365), col="green", lty=4, lwd= 2)
legend(11000, 0.2, c("Dogs"), pch = 16, col = c("blue"), bty = "n")
matplot(times, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100, 12000))
abline(v=c(9985/365), col="green", lty=4, lwd= 2)
legend("bottomright", c("Dogs"), pch = 16, col = c("blue"), bty = "n")
matplot(times, outTx2$Y, type='l', ylab = "Proportion Infected (%)", xlab = "Days",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("red"), xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=2, lwd= 2)
legend("bottomright", .2, c("Bugs"), pch = 16, col = c("red"), bty = "n")
matplot(times, outTx2$Y, type='l', ylab = "Proportion Infected (%)", xlab = "Days",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("red"), xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=2, lwd= 2)
legend("bottomright", .2, c("Bugs"), pch = 16, col = c("red"), bty = "n")
matplot(times, outTx2$Y, type='l', ylab = "Proportion Infected (%)", xlab = "Days",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("red"))
abline(v=c(9985/365), col="green", lty=2, lwd= 2)
legend("bottomright", .2, c("Bugs"), pch = 16, col = c("red"), bty = "n")
matplot(times, outTx2$Y, type='l', ylab = "Proportion Infected (%)", xlab = "Days",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("red"))
abline(v=c(9985/365), col="green", lty=2, lwd= 2)
legend("bottomleft", c("Bugs"), pch = 16, col = c("red"), bty = "n")
matplot(times/365, outTx2$Y, type='l', ylab = "Proportion Infected (%)", xlab = "Days",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("red"))
abline(v=c(9985/365), col="green", lty=2, lwd= 2)
legend("bottomleft", c("Bugs"), pch = 16, col = c("red"), bty = "n")
matplot(times/365, outTx2$Y, type='l', ylab = "Proportion Infected (%)", xlab = "Days",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("red"),  xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=2, lwd= 2)
legend("bottomleft", c("Bugs"), pch = 16, col = c("red"), bty = "n")
matplot(times, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100, 12000))
abline(v=c(9985/365), col="green", lty=4, lwd= 2)
legend("bottomleft", c("Dogs"), pch = 16, col = c("blue"), bty = "n")
matplot(times, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=4, lwd= 2)
legend("bottomleft", c("Dogs"), pch = 16, col = c("blue"), bty = "n")
matplot(times/365, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=4, lwd= 2)
legend("bottomleft", c("Dogs"), pch = 16, col = c("blue"), bty = "n")
#=============================================
#   Plot Results
#   m     Bugs per Dog
#   X     Dog Prevalence
#   Y*m   Positive Bugs Per Dog
#   Y     Bug Prevalence
#=============================================
par(mfrow=c(1,2))
matplot(times/365, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=4, lwd= 2)
legend("bottomleft", c("Dogs"), pch = 16, col = c("blue"), bty = "n")
matplot(times/365, outTx2$Y, type='l', ylab = "Proportion Infected (%)", xlab = "Days",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("red"),  xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=2, lwd= 2)
legend("bottomleft", c("Bugs"), pch = 16, col = c("red"), bty = "n")
matplot(times/365, outTx2$Y, type='l', ylab = "Proportion Infected (%)", xlab = "Days",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("red"),  xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=2, lwd= 2)
legend("bottomleft", c("Bugs"), pch = 16, col = c("red"), bty = "n")
matplot(times/365, outTx2$Y, type='l', ylab = "Proportion Infected (%)", xlab = "Days",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("red"),  xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=2, lwd= 2)
legend("bottomleft", c("Bugs"), pch = 16, col = c("red"), bty = "n")
#=============================================
#   Plot Results
#   m     Bugs per Dog
#   X     Dog Prevalence
#   Y*m   Positive Bugs Per Dog
#   Y     Bug Prevalence
#=============================================
par(mfrow=c(1,2))
matplot(times/365, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=4, lwd= 2)
legend("bottomleft", c("Dogs"), pch = 16, col = c("blue"), bty = "n")
matplot(times/365, outTx2$Y, type='l', ylab = "Proportion Infected (%)", xlab = "Days",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("red"),  xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=2, lwd= 2)
legend("bottomleft", c("Bugs"), pch = 16, col = c("red"), bty = "n")
matplot(times/365, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=4, lwd= 2)
legend("bottomright", c("Dogs"), pch = 16, col = c("blue"), bty = "n")
matplot(times/365, outTx2$Y, type='l', ylab = "Proportion Infected (%)", xlab = "Days",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("red"),  xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=2, lwd= 2)
legend("bottomright", c("Bugs"), pch = 16, col = c("red"), bty = "n")
matplot(times/365, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main= "Proportion Infected Dogs",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=4, lwd= 2)
matplot(times/365, outTx2$Y, type='l', ylab = "Proportion Infected (%)", xlab = "Days", main= "Proportion Infected Bugs",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("red"),  xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=2, lwd= 2)
matplot(times/365, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main= "Proportion Infected Dogs \n Dog lifespan 3 yrs",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=4, lwd= 2)
#legend("bottomright", c("Dogs"), pch = 16, col = c("blue"), bty = "n")
matplot(times/365, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main= "Proportion Infected Dogs",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=4, lwd= 2)
#legend("bottomright", c("Dogs"), pch = 16, col = c("blue"), bty = "n")
matplot(times/365, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main= "Proportion Infected Dogs",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=4, lwd= 2)
#legend("bottomright", c("Dogs"), pch = 16, col = c("blue"), bty = "n")
matplot(times/365, outTx2$Y, type='l', ylab = "Proportion Infected (%)", xlab = "Days", main= "Proportion Infected Bugs",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("red"),  xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=2, lwd= 2)
#=============================================
#   Plot Results
#   m     Bugs per Dog
#   X     Dog Prevalence
#   Y*m   Positive Bugs Per Dog
#   Y     Bug Prevalence
#=============================================
par(mfrow=c(1,2))
matplot(times/365, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main= "Proportion Infected Dogs",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=4, lwd= 2)
matplot(times/365, outTx2$Y, type='l', ylab = "Proportion Infected (%)", xlab = "Time (years)", main= "Proportion Infected Bugs",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("red"),  xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=2, lwd= 2)
initTx2 <- c(X = 0.01, Y= 0, m=40)
parametersTx2 <- c(a=1/14, b=0.00068, n=45, g=0.01, c=0.28, k=.10, r= 1/(2*365), p=0.8, K=40, R= 0.09)
outTx2 <- as.data.frame(ode(y = initTx2, times = times, func = RMTx2, parms = parametersTx2))
RESULTS2<-data.frame(outTx2$X,outTx2$Y)
RESULTS2m <-data.frame(outTx2$m, outTx2$Y*outTx2$m)
matplot(times/365, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main= "Proportion Infected Dogs",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=4, lwd= 2)
matplot(times/365, outTx2$Y, type='l', ylab = "Proportion Infected (%)", xlab = "Time (years)", main= "Proportion Infected Bugs",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("red"),  xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=2, lwd= 2)
#legend("bottomright", c("Bugs"), pch = 16, col = c("red"), bty = "n")
#=============================================
#   Plot Results
#   m     Bugs per Dog
#   X     Dog Prevalence
#   Y*m   Positive Bugs Per Dog
#   Y     Bug Prevalence
#=============================================
par(mfrow=c(1,2))
matplot(times/365, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main= "Proportion Infected Dogs",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=4, lwd= 2)
#legend("bottomright", c("Dogs"), pch = 16, col = c("blue"), bty = "n")
matplot(times/365, outTx2$Y, type='l', ylab = "Proportion Infected (%)", xlab = "Time (years)", main= "Proportion Infected Bugs",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("red"),  xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=2, lwd= 2)
#legend("bottomright", c("Bugs"), pch = 16, col = c("red"), bty = "n")
initTx2 <- c(X = 0.01, Y= 0, m=40)
parametersTx2 <- c(a=1/14, b=0.00068, n=45, g=0.01, c=0.28, k=.10, r= 1/(5*365), p=0.8, K=40, R= 0.09)
outTx2 <- as.data.frame(ode(y = initTx2, times = times, func = RMTx2, parms = parametersTx2))
RESULTS2<-data.frame(outTx2$X,outTx2$Y)
RESULTS2m <-data.frame(outTx2$m, outTx2$Y*outTx2$m)
matplot(times/365, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main= "Proportion Infected Dogs",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=4, lwd= 2)
matplot(times/365, outTx2$Y, type='l', ylab = "Proportion Infected (%)", xlab = "Time (years)", main= "Proportion Infected Bugs",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("red"),  xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=2, lwd= 2)
initTx2 <- c(X = 0.01, Y= 0, m=40)
parametersTx2 <- c(a=1/14, b=0.00068, n=45, g=0.01, c=0.28, k=.10, r= 1/(2*365), p=0.8, K=40, R= 0.09)
outTx2 <- as.data.frame(ode(y = initTx2, times = times, func = RMTx2, parms = parametersTx2))
RESULTS2<-data.frame(outTx2$X,outTx2$Y)
RESULTS2m <-data.frame(outTx2$m, outTx2$Y*outTx2$m)
matplot(times/365, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main= "Proportion Infected Dogs \n Average lifespan 2 years",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=4, lwd= 2)
#=============================================
#   Plot Results
#   m     Bugs per Dog
#   X     Dog Prevalence
#   Y*m   Positive Bugs Per Dog
#   Y     Bug Prevalence
#=============================================
par(mfrow=c(1,2))
matplot(times/365, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main= "Proportion Infected Dogs \n Average lifespan 2 years",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=4, lwd= 2)
initTx2 <- c(X = 0.01, Y= 0, m=40)
parametersTx2 <- c(a=1/14, b=0.00068, n=45, g=0.01, c=0.28, k=.10, r= 1/(4.5*365), p=0.8, K=40, R= 0.09)
outTx2 <- as.data.frame(ode(y = initTx2, times = times, func = RMTx2, parms = parametersTx2))
RESULTS2<-data.frame(outTx2$X,outTx2$Y)
RESULTS2m <-data.frame(outTx2$m, outTx2$Y*outTx2$m)
matplot(times/365, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main= "Proportion Infected Dogs \n Average lifespan 4.5 years",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100/365, 12000/365))
abline(v=c(9985/365), col="green", lty=4, lwd= 2)
runApp('FullTwoGraphs')
runApp('FullTwoGraphs')
library(deSolve)
#Initial vectors for days post treatment, % killed
x <- c(4, 30, 60, 90, 120, 210, 360) #days post treatment
z <- c(1.0, 0.99, 0.99, 0.79, 0.7, 0.02, 0) #% killed
plot(z ~ x)
fit2 <- nls(y ~ SSlogis(x, Asym, xmid, scal), data = data.frame(x, y))
summary(fit2)
lines(seq(0, 400, length.out = 400),
predict(fit2, newdata = data.frame(x = seq(0.5, 400, length.out = 400))))
Asym<-summary(fit2)$parameters[1,1]
xmid<-summary(fit2)$parameters[2,1]
scal<-summary(fit2)$parameters[3,1]
times <- seq(0, 20000, by = 1)
signal <- data.frame(times = times, import = rep(0, length(times)))
trt2.function <- function(fit2, trt.days, signal) {
Asym<-summary(fit2)$parameters[1,1]
xmid<-summary(fit2)$parameters[2,1]
scal<-summary(fit2)$parameters[3,1]
trt.start <- trt.days
trt.end <- c(trt.start + 400)
trt.segments <- unlist(Map(':', trt.start, trt.end))
time.segments <- rep(0:401, times=length(trt.start))
signal$import[trt.segments] = (Asym / (1 + exp((xmid - times[time.segments]) / scal)))
return(signal)
}
trt.days <- c(10000)
out <-trt2.function(fit2, trt.days, signal)
input <- approxfun(out, rule = 2)
RMTx2 <- function(times, stateTx2, parametersTx2)
{
with(
as.list(c(stateTx2, parametersTx2)),
{
z <- input(times)
dX <- ((m*a*b*Y)+(p*k*(a*m*z*Y)))*(1-X)-r*X #jr added density dependent mortality   #dx: change in proportion of infected dogs.  Vectorial transmission is the first term (m*a*b*Y), oral transmission the second (k*q*Y)
dY <- a*c*X*(exp(-g*n)-Y)-((g*(1-m/K)*Y)+(m*a*z*Y)) #dx: change in proportion of infected bugs.  mzl added density dependent mortality
dm <- ((R*(1-m/K)*m )+(-m*a*z)) #where the ratio of bugs: dog decreases by (-maz) and increases by logistic growth for bug population (R*(1-m/K)*m )
return(list(c(dX, dY, dm)))
}
)
}
initTx2 <- c(X = 0.01, Y= 0, m=40)
parametersTx2 <- c(a=1/14, b=0.00068, n=45, g=0.01, c=0.28, k=.10, r= 1/(4.5*365), p=0.2, K=40, R= 0.09)
outTx2 <- as.data.frame(ode(y = initTx2, times = times, func = RMTx2, parms = parametersTx2))
RESULTS2<-data.frame(outTx2$X,outTx2$Y)
RESULTS2m <-data.frame(outTx2$m, outTx2$Y*outTx2$m)
#=============================================
#   Plot Results
#   m     Bugs per Dog
#   X     Dog Prevalence
#   Y*m   Positive Bugs Per Dog
#   Y     Bug Prevalence
#=============================================
par(mfrow=c(1,3))
matplot(times/365, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main= "Proportion Infected- Dogs \n  consuming 20% of dead bugs",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100/365, 12000/365))
abline(v=c(10000/365), col="green", lty=4, lwd= 2)
#legend("bottomright", c("Dogs"), pch = 16, col = c("blue"), bty = "n")
initTx2 <- c(X = 0.01, Y= 0, m=40)
parametersTx2 <- c(a=1/14, b=0.00068, n=45, g=0.01, c=0.28, k=.10, r= 1/(4.5*365), p=0.5, K=40, R= 0.09)
outTx2 <- as.data.frame(ode(y = initTx2, times = times, func = RMTx2, parms = parametersTx2))
RESULTS2<-data.frame(outTx2$X,outTx2$Y)
RESULTS2m <-data.frame(outTx2$m, outTx2$Y*outTx2$m)
matplot(times/365, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main= "Proportion Infected- Dogs \n  consuming 50% of dead bugs",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100/365, 12000/365))
abline(v=c(10000/365), col="green", lty=4, lwd= 2)
#legend("bottomright", c("Dogs"), pch = 16, col = c("blue"), bty = "n")
initTx2 <- c(X = 0.01, Y= 0, m=40)
parametersTx2 <- c(a=1/14, b=0.00068, n=45, g=0.01, c=0.28, k=.10, r= 1/(4.5*365), p=1, K=40, R= 0.09)
outTx2 <- as.data.frame(ode(y = initTx2, times = times, func = RMTx2, parms = parametersTx2))
RESULTS2<-data.frame(outTx2$X,outTx2$Y)
RESULTS2m <-data.frame(outTx2$m, outTx2$Y*outTx2$m)
matplot(times/365, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main= "Proportion Infected- Dogs \n  consuming 100% of dead bugs",
cex.main=0.8, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100/365, 12000/365))
abline(v=c(10000/365), col="green", lty=4, lwd= 2)
#legend("bottomright", c("Dogs"), pch = 16, col = c("blue"), bty = "n")
initTx2 <- c(X = 0.01, Y= 0, m=40)
parametersTx2 <- c(a=1/14, b=0.00068, n=45, g=0.01, c=0.28, k=.10, r= 1/(4.5*365), p=0.1, K=40, R= 0.09)
outTx2 <- as.data.frame(ode(y = initTx2, times = times, func = RMTx2, parms = parametersTx2))
RESULTS2<-data.frame(outTx2$X,outTx2$Y)
RESULTS2m <-data.frame(outTx2$m, outTx2$Y*outTx2$m)
#times <- seq(0, 10000, by = 1)
#timesTx2 <- seq(0, 10000, by = 1)
#=============================================
#   Plot Results
#   m     Bugs per Dog
#   X     Dog Prevalence
#   Y*m   Positive Bugs Per Dog
#   Y     Bug Prevalence
#=============================================
par(mfrow=c(1,3))
matplot(times/365, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main= "Consuming 10% of dead bugs",
cex.main=1, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100/365, 12000/365))
abline(v=c(10000/365), col="green", lty=4, lwd= 2)
initTx2 <- c(X = 0.01, Y= 0, m=40)
parametersTx2 <- c(a=1/14, b=0.00068, n=45, g=0.01, c=0.28, k=.10, r= 1/(4.5*365), p=0.5, K=40, R= 0.09)
outTx2 <- as.data.frame(ode(y = initTx2, times = times, func = RMTx2, parms = parametersTx2))
RESULTS2<-data.frame(outTx2$X,outTx2$Y)
RESULTS2m <-data.frame(outTx2$m, outTx2$Y*outTx2$m)
#times <- seq(0, 10000, by = 1)
#timesTx2 <- seq(0, 10000, by = 1)
matplot(times/365, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main= "Consuming 50% of dead bugs",
cex.main=1, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100/365, 12000/365))
abline(v=c(10000/365), col="green", lty=4, lwd= 2)
initTx2 <- c(X = 0.01, Y= 0, m=40)
parametersTx2 <- c(a=1/14, b=0.00068, n=45, g=0.01, c=0.28, k=.10, r= 1/(4.5*365), p=1, K=40, R= 0.09)
outTx2 <- as.data.frame(ode(y = initTx2, times = times, func = RMTx2, parms = parametersTx2))
RESULTS2<-data.frame(outTx2$X,outTx2$Y)
RESULTS2m <-data.frame(outTx2$m, outTx2$Y*outTx2$m)
#times <- seq(0, 10000, by = 1)
matplot(times/365, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main= "Consuming 100% of dead bugs",
cex.main=1, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9100/365, 12000/365))
abline(v=c(10000/365), col="green", lty=4, lwd= 2)
#legend("bottomright", c("Dogs"), pch = 16, col = c("blue"), bty = "n")
initTx2 <- c(X = 0.01, Y= 0, m=40)
parametersTx2 <- c(a=1/14, b=0.00068, n=45, g=0.01, c=0.28, k=.10, r= 1/(4.5*365), p=.1, K=40, R= 0.09)
outTx2 <- as.data.frame(ode(y = initTx2, times = times, func = RMTx2, parms = parametersTx2))
RESULTS2<-data.frame(outTx2$X,outTx2$Y)
RESULTS2m <-data.frame(outTx2$m, outTx2$Y*outTx2$m)
#times <- seq(0, 10000, by = 1)
#timesTx2 <- seq(0, 10000, by = 1)
#=============================================
#   Plot Results
#   m     Bugs per Dog
#   X     Dog Prevalence
#   Y*m   Positive Bugs Per Dog
#   Y     Bug Prevalence
#=============================================
par(mfrow=c(1,3))
matplot(times/365, outTx2$Y, type='l', ylab = "Proportion Infected (%)", xlab = "Time (years)", main= "Consuming 10% of dead bugs",
cex.main=1, lwd =2, lty = 1, bty = "l", col = c("red"),  xlim= c(9100/365, 12000/365))
abline(v=c(10000/365), col="green", lty=2, lwd= 2)
initTx2 <- c(X = 0.01, Y= 0, m=40)
parametersTx2 <- c(a=1/14, b=0.00068, n=45, g=0.01, c=0.28, k=.10, r= 1/(4.5*365), p=.5, K=40, R= 0.09)
outTx2 <- as.data.frame(ode(y = initTx2, times = times, func = RMTx2, parms = parametersTx2))
RESULTS2<-data.frame(outTx2$X,outTx2$Y)
RESULTS2m <-data.frame(outTx2$m, outTx2$Y*outTx2$m)
#times <- seq(0, 10000, by = 1)
#timesTx2 <- seq(0, 10000, by = 1)
matplot(times/365, outTx2$Y, type='l', ylab = "Proportion Infected (%)", xlab = "Time (years)", main= "Consuming 50% of dead bugs",
cex.main=1, lwd =2, lty = 1, bty = "l", col = c("red"),  xlim= c(9100/365, 12000/365))
abline(v=c(10000/365), col="green", lty=2, lwd= 2)
initTx2 <- c(X = 0.01, Y= 0, m=40)
parametersTx2 <- c(a=1/14, b=0.00068, n=45, g=0.01, c=0.28, k=.10, r= 1/(4.5*365), p=1, K=40, R= 0.09)
outTx2 <- as.data.frame(ode(y = initTx2, times = times, func = RMTx2, parms = parametersTx2))
RESULTS2<-data.frame(outTx2$X,outTx2$Y)
RESULTS2m <-data.frame(outTx2$m, outTx2$Y*outTx2$m)
#times <- seq(0, 10000, by = 1)
#timesTx2 <- seq(0, 10000, by = 1)
matplot(times/365, outTx2$Y, type='l', ylab = "Proportion Infected (%)", xlab = "Time (years)", main= "Consuming 100% of dead bugs",
cex.main=1, lwd =2, lty = 1, bty = "l", col = c("red"),  xlim= c(9100/365, 12000/365))
abline(v=c(10000/365), col="green", lty=2, lwd= 2)
#legend("bottomright", c("Bugs"), pch = 16, col = c("red"), bty = "n")
RM <- function(time, state, parameters)
{
with(
as.list(c(state, parameters)),
{
dX <- m*a*b*Y*(1-X)-r*X
dY <- a*c*X*(exp(-g*n)-Y)-(g*Y)
dm <- (R*(1-m/K)*m )
return(list(c(dX, dY, dm)))
}
)
}
init <- c(X = 0.01, Y = 0, m= 40)
parameters <- c(a=1/14, b=0.00068, m=40, n=45, g=0.005, c=0.24, r=1/(2*365), K = 40, R= 0.09)
times <- seq(0, 20000, by = 1)
out <- as.data.frame(ode(y = init, times = times, func = RM, parms = parameters))
RESULTS<-data.frame(out$X,out$Y)
RESULTSm <-data.frame(out$m)
par(mfrow=c(1,2))
matplot(times, RESULTS, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main = "Average Lifespan 2 years",
cex.main= 1, lwd = 2, lty = 1, bty = "l", col = c("blue","red"))
legend(14000, .2, c("Dogs", "Triatomines"), pch = 16, col = c("blue","red"))
matplot(times, RESULTS, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main = "Average Lifespan 2 years",
cex.main= 1, lwd = 2, lty = 1, bty = "l", col = c("blue","red"), bty= "n")
legend("bottomleft", c("Dogs", "Triatomines"), pch = 16, col = c("blue","red"))
#========Proportion dogs and bugs infected===
matplot(times, RESULTS, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main = "Average Lifespan 2 years",
cex.main= 1, lwd = 2, lty = 1, bty = "l", col = c("blue","red"))
legend("bottomleft", c("Dogs", "Triatomines"), pch = 16, col = c("blue","red"), bty= "n")
par(mfrow=c(1,2))
matplot(times, RESULTS, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main = "Average Lifespan 2 years",
cex.main= 1, lwd = 2, lty = 1, bty = "l", col = c("blue","red"))
legend("bottomleft", c("Dogs", "Triatomines"), pch = 16, col = c("blue","red"), bty= "n")
init <- c(X = 0.01, Y = 0, m= 40)
parameters <- c(a=1/14, b=0.00068, m=40, n=45, g=0.005, c=0.24, r=1/(4*365), K = 40, R= 0.09)
times <- seq(0, 20000, by = 1)
out <- as.data.frame(ode(y = init, times = times, func = RM, parms = parameters))
RESULTS<-data.frame(out$X,out$Y)
RESULTSm <-data.frame(out$m)
matplot(times, RESULTS, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main = "Average Lifespan 4 years",
cex.main= 1, lwd = 2, lty = 1, bty = "l", col = c("blue","red"))
legend("bottomleft", c("Dogs", "Triatomines"), pch = 16, col = c("blue","red"), bty= "n")
matplot(times, RESULTS, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main = "Average Lifespan 4 years",
cex.main= 1, lwd = 2, lty = 1, bty = "l", col = c("blue","red"))
legend("bottomleft", c("Dogs", "Triatomines"), pch = 16, col = c("blue","red"), bty= "n", cex = 0.8)
init <- c(X = 0.01, Y = 0, m= 40)
parameters <- c(a=1/14, b=0.00068, m=40, n=45, g=0.005, c=0.24, r=1/(2*365), K = 40, R= 0.09)
times <- seq(0, 20000, by = 1)
out <- as.data.frame(ode(y = init, times = times, func = RM, parms = parameters))
RESULTS<-data.frame(out$X,out$Y)
RESULTSm <-data.frame(out$m)
par(mfrow=c(1,2))
#========Proportion dogs and bugs infected===
matplot(times, RESULTS, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main = "Average Lifespan 2 years",
cex.main= 1, lwd = 2, lty = 1, bty = "l", col = c("blue","red"))
legend("bottomleft", c("Dogs", "Triatomines"), pch = 16, col = c("blue","red"), bty= "n", cex = 0.8)
init <- c(X = 0.01, Y = 0, m= 40)
parameters <- c(a=1/14, b=0.00068, m=40, n=45, g=0.005, c=0.24, r=1/(4*365), K = 40, R= 0.09)
times <- seq(0, 20000, by = 1)
out <- as.data.frame(ode(y = init, times = times, func = RM, parms = parameters))
RESULTS<-data.frame(out$X,out$Y)
RESULTSm <-data.frame(out$m)
matplot(times, RESULTS, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main = "Average Lifespan 4 years",
cex.main= 1, lwd = 2, lty = 1, bty = "l", col = c("blue","red"))
legend("bottomleft", c("Dogs", "Triatomines"), pch = 16, col = c("blue","red"), bty= "n", cex = 0.8)
init <- c(X = 0.01, Y = 0, m= 40)
parameters <- c(a=1/14, b=0.00068, m=40, n=45, g=0.005, c=0.24, r=1/(6*365), K = 40, R= 0.09)
times <- seq(0, 20000, by = 1)
out <- as.data.frame(ode(y = init, times = times, func = RM, parms = parameters))
RESULTS<-data.frame(out$X,out$Y)
RESULTSm <-data.frame(out$m)
par(mfrow=c(1,2))
matplot(times, RESULTS, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main = "Average Lifespan 6 years",
cex.main= 1, lwd = 2, lty = 1, bty = "l", col = c("blue","red"))
legend("bottomleft", c("Dogs", "Triatomines"), pch = 16, col = c("blue","red"), bty= "n", cex = 0.8)
init <- c(X = 0.01, Y = 0, m= 40)
parameters <- c(a=1/14, b=0.00068, m=40, n=45, g=0.005, c=0.24, r=1/(8*365), K = 40, R= 0.09)
times <- seq(0, 20000, by = 1)
out <- as.data.frame(ode(y = init, times = times, func = RM, parms = parameters))
RESULTS<-data.frame(out$X,out$Y)
RESULTSm <-data.frame(out$m)
#========Proportion dogs and bugs infected===
matplot(times, RESULTS, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main = "Average Lifespan 8 years",
cex.main= 1, lwd = 2, lty = 1, bty = "l", col = c("blue","red"))
legend("bottomleft", c("Dogs", "Triatomines"), pch = 16, col = c("blue","red"), bty= "n", cex = 0.8)
init <- c(X = 0.01, Y = 0, m= 40)
parameters <- c(a=1/14, b=0.00068, m=40, n=45, g=0.005, c=0.24, r=1/(2*365), K = 40, R= 0.09)
times <- seq(0, 20000, by = 1)
out <- as.data.frame(ode(y = init, times = times, func = RM, parms = parameters))
RESULTS<-data.frame(out$X,out$Y)
RESULTSm <-data.frame(out$m)
#========Proportion dogs and bugs infected===
matplot(times, RESULTS, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main = "Average Lifespan 2 years",
cex.main= 1, lwd = 2, lty = 1, bty = "l", col = c("blue","red"))
legend("bottomleft", c("Dogs", "Triatomines"), pch = 16, col = c("blue","red"), bty= "n", cex = 0.8)
init <- c(X = 0.01, Y = 0, m= 40)
parameters <- c(a=1/14, b=0.00068, m=40, n=45, g=0.005, c=0.24, r=1/(4*365), K = 40, R= 0.09)
times <- seq(0, 20000, by = 1)
out <- as.data.frame(ode(y = init, times = times, func = RM, parms = parameters))
RESULTS<-data.frame(out$X,out$Y)
RESULTSm <-data.frame(out$m)
matplot(times, RESULTS, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main = "Average Lifespan 4 years",
cex.main= 1, lwd = 2, lty = 1, bty = "l", col = c("blue","red"))
legend("bottomleft", c("Dogs", "Triatomines"), pch = 16, col = c("blue","red"), bty= "n", cex = 0.8)
initTx2 <- c(X = 0.01, Y= 0, m=40)
parametersTx2 <- c(a=1/14, b=0.00068, n=45, g=0.01, c=0.28, k=.10, r= 1/(3*365), p=1, K=40, R= 0.09)
outTx2 <- as.data.frame(ode(y = initTx2, times = times, func = RMTx2, parms = parametersTx2))
RESULTS2<-data.frame(outTx2$X,outTx2$Y)
RESULTS2m <-data.frame(outTx2$m, outTx2$Y*outTx2$m)
#times <- seq(0, 10000, by = 1)
#timesTx2 <- seq(0, 10000, by = 1)
matplot(times/365, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main= "Consuming 100% of dead bugs",
cex.main=1, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9500/365, 11000/365))
abline(v=c(10000/365), col="green", lty=4, lwd= 2)
#legend("bottomright", c("Dogs"), pch = 16, col = c("blue"), bty = "n")
matplot(times/365, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main= "Consuming 100% of dead bugs",
cex.main=1, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9500/365, 11000/365))
abline(v=c(10000/365), col="green", lty=4, lwd= 2)
#legend("bottomright", c("Dogs"), pch = 16, col = c("blue"), bty = "n")
matplot(times, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main= "Consuming 100% of dead bugs",
cex.main=1, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9500, 11000))
abline(v=c(10000), col="green", lty=4, lwd= 2)
#legend("bottomright", c("Dogs"), pch = 16, col = c("blue"), bty = "n")
matplot(times, outTx2$Y, type='l', ylab = "Proportion Infected (%)", xlab = "Time (years)", main= "Consuming 100% of dead bugs",
cex.main=1, lwd =2, lty = 1, bty = "l", col = c("red"),  xlim= c(9500, 11000))
abline(v=c(10000/365), col="green", lty=2, lwd= 2)
#legend("bottomright", c("Bugs"), pch = 16, col = c("red"), bty = "n")
initTx2 <- c(X = 0.01, Y= 0, m=40)
parametersTx2 <- c(a=1/14, b=0.00068, n=45, g=0.01, c=0.28, k=.10, r= 1/(3*365), p=0.8, K=40, R= 0.09)
outTx2 <- as.data.frame(ode(y = initTx2, times = times, func = RMTx2, parms = parametersTx2))
RESULTS2<-data.frame(outTx2$X,outTx2$Y)
RESULTS2m <-data.frame(outTx2$m, outTx2$Y*outTx2$m)
matplot(times, outTx2$X, type = "l", xlab = "Time (years)", ylab = "Proportion Infected (%)", main= "Consuming 100% of dead bugs",
cex.main=1, lwd =2, lty = 1, bty = "l", col = c("blue","red"), xlim= c(9500, 11000))
abline(v=c(10000), col="green", lty=4, lwd= 2)
#legend("bottomright", c("Dogs"), pch = 16, col = c("blue"), bty = "n")
shiny::runApp('FullTwoGraphs')
getEq<-function(a=1/14, b=.00068, m=40, n=45, g=.005, c=.28, r=1/(3*365), yonly=T)
{
R0 <- (m*(a^2)*b*c*exp(-g*n)) / (r*g)
S<-a/g
Xeq<-(R0-1)/(R0+(c*S))
Yeq<-((a*c*Xeq)/(g+a*c*Xeq))*exp((-g*n))
togo<-c(R0,Xeq,Yeq)
if(yonly==F) return(togo)
if(yonly==T) return(Yeq)
}
print(getEq)
getEq<-function(a=1/14, b=.00068, m=40, n=45, g=.005, c=.28, r=1/(3*365), yonly=T)
{
R0 <- (m*(a^2)*b*c*exp(-g*n)) / (r*g)
S<-a/g
Xeq<-(R0-1)/(R0+(c*S))
Yeq<-((a*c*Xeq)/(g+a*c*Xeq))*exp((-g*n))
togo<-c(R0,Xeq,Yeq)
if(yonly==F) return(togo)
if(yonly==T) return(Yeq)
print(getEq)
getEq(dX)
getEq(dX)
